---
title: "STAT 331 Portfolio"
author: "Sydney Lunasin"
format: html 
embed-resources: true
layout: margin-left
editor: visual
execute: 
  eval: false
  echo: true
---

[**My Grade:**]{.underline} I believe my grade equivalent to course work evidenced below to be an B.

[**Learning Objective Evidence:**]{.underline} In the code chunks below, provide code from Lab or Challenge assignments where you believe you have demonstrated proficiency with the specified learning target. Be sure to specify **where** the code came from (e.g., Lab 4 Question 2).

## Working with Data

**WD-1: I can import data from a *variety* of formats (e.g., csv, xlsx, txt, etc.).**

-   `csv` Example 1

```{r}
#| label: wd-1-csv-1
# Lab 3
teacher_evals <- read_csv(here::here("Week 3", "Lab 3", "teacher_evals.csv"))

```

-   `csv` Example 2

```{r}
#| label: wd-1-csv-2
# Lab 4
childcare_costs <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/childcare_costs.csv')
```

-   `xlsx`

```{r}
#| label: wd-1-xlsx
# Practive Activity 4
library(readxl)
military <- read_xlsx("gov_spending_per_capita.xlsx",
                      sheet = "Share of Govt. spending",
                      skip  = 7,
                      n_max = 190,
                      na = c(". .", "xxx", "..")
                      )
```

**WD-2: I can select necessary columns from a dataset.**

-   Example selecting specified columns

```{r}
#| label: wd-2-ex-1
#From Lab 4 Q5
median_house_income <- ca_childcare |> 
  select(census_region, study_year, mhi_2018) |> 
  group_by(census_region, study_year) |> 
  summarise(median_mhi = median(mhi_2018, na.rm = TRUE), .groups = "drop") |> 
  pivot_wider(names_from = study_year,
              values_from = median_mhi,
              names_prefix = "year_") |> 
  select(census_region,`year_2008`, `year_2018`) |> 
  arrange(desc(`year_2018`))

median_house_income
```

-   Example removing specified columns

```{r}
#| label: wd-2-ex-2
# Lab 5 Modified
suspect_description <- drivers_license |> 
  right_join(x = person,
             y = drivers_license,
             by = join_by(license_id == id)) |> 
  filter(height >= 65, height <= 67,
         hair_color == "red",
         gender == "female",
         car_make == "Tesla",
         car_model == "Model S") |> 
  select(-c(address_number, address_street_name, age))
suspect_description
```

-   Example selecting columns based on logical values (e.g., `starts_with()`, `ends_with()`, `contains()`, `where()`)

```{r}
#| label: wd-2-ex-3
# From Lab 4 Q7
one_table <- ca_childcare |>
  select(census_region, study_year, mc_infant, mc_toddler, mc_preschool) |> 
  pivot_longer(
    cols = starts_with("mc_"),
    names_to = "age_group",
    names_pattern = "(infant|toddler|preschool)"
    ) |>
  rename(median_childcare = value) |> 
  mutate(age_group = factor(age_group, levels = c("infant","toddler","preschool"))
  )
one_table

```

**WD-3: I can filter rows from a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-3-numeric-ex-1
# From Lab 4 Q6
ca_childcare |> 
  filter(study_year == 2018) |> 
  select(census_region, study_year, mc_infant) |> 
  group_by(census_region, study_year) |>
  summarise(median_mc_infant = median(mc_infant, na.rm = TRUE), .groups = "drop") |>
  pivot_wider(names_from = study_year,
              values_from = median_mc_infant) |> 
  slice_min(`2018`)
```

-   Numeric Example 2

```{r}
#| label: wd-3-numeric-ex-2
# Challenge 3 Q1
teacher_evals_compare <- teacher_evals |> 
  filter(question_no == 903) |> 
  mutate(SET_level = if_else(SET_score_avg >= 4, "excellent", "standard"),
         sen_level = case_when(seniority <= 4 ~ "junior",
                               between(seniority, 5,8) ~ "senior",
                               seniority > 8 ~ "very senior")) |> 
  select(course_id, SET_level, sen_level)

teacher_evals_compare  

```

-   Character Example 1 (any context)

```{r}
#| label: wd-3-character
# Lab 5
witnesses <- person |> 
  filter(
    (address_street_name == "Northwestern Dr" &
       address_number == max(address_number[address_street_name == "Northwestern Dr"])) |
    (address_street_name == "Franklin Ave" &
       str_detect(name, "^Annabel")))  
witnesses

```

-   Character Example 2 (example must use functions from **stringr**)

```{r}
#| label: wd-3-string
# Lab 5
first_witness_info <- 
  right_join(x = person,
             y = drivers_license,
             by = join_by(license_id == id)) |> 
  filter(str_detect(plate_number,
                    pattern = "H42W"))
first_witness_info
```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-3-date
# Lab 5 Modified
suspect_concert <- 
  left_join(x = suspect_description,
            y = facebook_event_checkin,
            by = join_by(id == person_id)) |> 
  mutate(date = ymd(date)) |> 
  filter(event_name == "SQL Symphony Concert",
         year(date) == 2017,
         month(date) == 12)
suspect_concert

```

**WD-4: I can modify existing variables and create new variables in a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-4-numeric-ex-1
# Lab 3 Q5
teacher_evals_clean <- teacher_evals |> 
  rename(sex = gender) |> 
   mutate(teacher_id = as.character(teacher_id),
          no_participants = as.numeric(no_participants),
          question_no = as.character(question_no)) |> 
   filter(no_participants > 10) |>
   select(course_id,
          teacher_id,
          question_no,
          no_participants,
          resp_share,
          SET_score_avg,
          percent_failed_cur,
          academic_degree,
          seniority,
          sex)
  
teacher_evals_clean

```

-   Numeric Example 2

```{r}
#| label: wd-4-numeric-ex-2
#Challenge 3 Q1
teacher_evals_compare <- teacher_evals |> 
  filter(question_no == 903) |> 
  mutate(SET_level = if_else(SET_score_avg >= 4, "excellent", "standard"),
         sen_level = case_when(seniority <= 4 ~ "junior",
                               between(seniority, 5,8) ~ "senior",
                               seniority > 8 ~ "very senior")) |> 
  select(course_id, SET_level, sen_level)

teacher_evals_compare  

```

-   Factor Example 1 (renaming levels)

```{r}
#| label: wd-4-factor-ex-1
# Lab 4 Q4
ca_childcare <- ca_childcare |> 
  mutate(county_name = str_remove(county_name, " County"),
         census_region = fct_collapse(.f = county_name,
                                      "Superior California" = superior_counties,
                                      "North Coast" = north_coast_counties,
                                      "San Francisco Bay Area" = san_fran_counties,
                                      "Northern San Joaquin Valley" = n_san_joaquin_counties,
                                      "Central Coast" = central_coast_counties,
                                      "Southern San Joaquin Valley" = s_san_joaquin_counties,
                                      "Inland Empire" = inland_counties,
                                      "Los Angeles County" = la_county,
                                      "Orange County" = orange_county,
                                      "San Diego - Imperial" = san_diego_imperial_counties))
ca_childcare


```

-   Factor Example 2 (reordering levels)

```{r}
#| label: wd-4-factor-ex-2
# Lab 4 Q7
ggplot(data = one_table,
       mapping = aes(x = study_year, y = median_childcare, 
                  color = fct_reorder2(.f = census_region, 
                                       .x = study_year, 
                                       .y = median_childcare, 
                                       .fun = last2, 
                                       .desc = TRUE))) +
  # Raw data points
  geom_point() +
  # Smoothed median line
  geom_smooth(method = "loess",
              se= TRUE,
              linewidth = 1.2) +
  facet_wrap(~ age_group, nrow = 1, scales = "fixed") +
  scale_x_continuous(limits = c(2008,2018),
                     breaks = seq(2008, 2024, by = 2),
                     minor_breaks = NULL) +
  scale_y_continuous(limits = c(0,500),
                     breaks = seq(0,500, by = 100),
                     labels = scales::dollar_format(accuracy = 1)) +
  labs(title = "Weekly Median Price for Center-Based Childcare ($)",
       x = "Study Year",
       y = "",
       color = "California Region") +
  theme(aspect.ratio = 1,
        axis.text.x = element_text(size = 6))

```

-   Character (example must use functions from **stringr**)

```{r}
#| label: wd-4-string
# Lab 8
cool_plot <- function(df, x_var, y_var, fill_var){
  
  x_label <- str_to_title(str_replace_all(as_label(ensym(x_var)), "_", " "))
  y_label <- str_to_title(str_replace_all(as_label(ensym(y_var)), "_", " "))
  fill_label <- str_to_title(str_replace_all(as_label(ensym(fill_var)), "_", " "))
  
  label <- rlang::englue("A scatterplot of {x_label} and {y_label}")
  sub <- rlang::englue("A line of best fit is applied to each {fill_label}")
  
  ggplot(df, mapping = aes(x = {{x_var}}, y = {{y_var}}, fill = {{fill_var}})) +
    geom_point(shape = 21, size = 2) +
    geom_smooth(method = "lm", se = FALSE, color = "grey") +
    #scale_fill_brewer(palette = "YlGnBu") +
    labs(
      title = label,
      subtitle = sub,
      x = x_label,
      y = y_label
    )
}
```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-4-date
# Lab 5 Modified
suspect_concert <- 
  left_join(x = suspect_description,
            y = facebook_event_checkin,
            by = join_by(id == person_id)) |> 
  mutate(date = ymd(date)) |> 
  filter(event_name == "SQL Symphony Concert",
         year(date) == 2017,
         month(date) == 12)
suspect_concert
```

**WD-5: I can use mutating joins to combine multiple dataframes.**

-   `left_join()` Example 1

```{r}
#| label: wd-5-left-ex-1
# From Lab 4 Q3
ca_childcare <- ca_childcare |> 
  left_join(y = tax_rev,
            by = join_by(county_name == entity_name, study_year == year ))
ca_childcare

```

-   `right_join()` Example 1

```{r}
#| label: wd-5-right
# Lab 5
suspect_description <- drivers_license |> 
  right_join(x = person,
             y = drivers_license,
             by = join_by(license_id == id)) |> 
  filter(height >= 65, height <= 67,
         hair_color == "red",
         gender == "female",
         car_make == "Tesla",
         car_model == "Model S")
suspect_description

```

-   `left_join()` **or** `right_join()` Example 2

```{r}
#| label: wd-5-left-right-ex-2
# Lab 5
first_suspect_interview <-
  left_join(x = first_murder_suspect,
            y = interview,
            by = join_by(person_id)) |> 
  pull(transcript)

first_suspect_interview
```

-   `inner_join()` Example 1

```{r}
#| label: wd-5-inner-ex-1
# From Lab 4 Q2
ca_childcare <-
  filter(counties, state_name == "California") |> 
  inner_join(y = childcare_costs,
             by = "county_fips_code")
ca_childcare

```

-   `inner_join()` Example 2

```{r}
#| label: wd-5-inner-ex-2
# Lab 5
first_murder_suspect <-
  inner_join(x = second_witness_gym_info,
            y = first_witness_info,
            by = join_by(person_id == id))
first_murder_suspect

```

**WD-6: I can use filtering joins to filter rows from a dataframe.**

-   `semi_join()`

```{r}
#| label: wd-6-semi
# Lab 5 modified
suspect_concert <- 
  left_join(x = suspect_description,
            y = facebook_event_checkin,
            by = join_by(id == person_id)) |> 
  mutate(date = ymd(date)) |> 
  filter(event_name == "SQL Symphony Concert",
         year(date) == 2017,
         month(date) == 12)
suspect_concert

murder_suspect <- income |> 
  semi_join(suspect_concert,
            by = join_by(ssn))

```

-   `anti_join()`

```{r}
#| label: wd-6-anti
# Lab 5 modified
not_suspects <- person |> 
  filter(! ((address_street_name == "Northwestern Dr" &
          address_number == max(address_number[address_street_name == "Northwestern Dr"])) |
          (address_street_name == "Franklin Ave" &
          str_detect(name, "^Annabel"))))  

witness_transcript <-
  anti_join(interview,
            not_suspects,
            by = join_by(person_id == id))
witness_transcript
```

**WD-7: I can pivot dataframes from long to wide and visa versa**

-   `pivot_longer()`

```{r}
#| label: wd-7-long
# Lab 4 Q7
one_table <- ca_childcare |>
  select(census_region, study_year, mc_infant, mc_toddler, mc_preschool) |> 
  pivot_longer(
    cols = starts_with("mc_"),
    names_to = "age_group",
    names_pattern = "(infant|toddler|preschool)"
    ) |>
  rename(median_childcare = value) |> 
  mutate(age_group = factor(age_group, levels = c("infant","toddler","preschool"))
  )
one_table

```

-   `pivot_wider()`

```{r}
#| label: wd-7-wide
#From Lab 4 Q5, modified
median_house_income <- ca_childcare |> 
  select(census_region, study_year, mhi_2018) |> 
  group_by(census_region, study_year) |> 
  summarise(median_mhi = median(mhi_2018, na.rm = TRUE), .groups = "drop") |> 
  pivot_wider(names_from = study_year,
              values_from = median_mhi,
              names_prefix = "Median MHI, ") |> 
  select(census_region, "Median MHI, 2008", "Median MHI, 2018") |> 
  arrange(desc("Median MHI, 2018"))

median_house_income

```

## Reproducibility

**R-1: I can create professional looking, reproducible analyses using RStudio projects, Quarto documents, and the here package.**

The following assignments satisfy the above criteria:

-   Example 1- Lab 3
-   Example 2- Challenge 3
-   Example 3- Lab 4
-   Example 4- Challenge 4
-   Example 5- Lab 5

**R-2: I can write well documented and tidy code.**

-   Example of **ggplot2** plotting

```{r}
#| label: r-2-1
# Lab 2 Q16
ggplot(data = surveys,
       mapping = aes(x = weight, y = species, fill = sex)) +
  geom_jitter(color = '#7C6BB0FF', alpha = 0.2) +
  geom_boxplot(outliers = FALSE) +
  scale_fill_manual(values = c("F" = "#4060C8FF", "M" = "#F28AAAFF")) +
  labs(title = "Distribution of weight seen in different species",
       x = 'Weight (g)', y = 'Species') 


```

-   Example of **dplyr** pipeline

```{r}
#| label: r-2-2
# Challenge 4
plot_data <- ca_childcare |> 
  select(me_2018, fme_2018, mme_2018, mc_infant) |>
  pivot_longer(cols = c('me_2018', 'fme_2018', 'mme_2018'),
               names_to = "metric",
               values_to = "median_value")
```

-   Example of function formatting

```{r}
#| label: r-2-3
# Lab 8 
pivot_table <- function(df, row, col){
  if (!is.data.frame(df)) return(NA)
  df |> 
    count({{row}}, {{col}}) |> 
    pivot_wider(names_from = {{row}},
                values_from = n,
                values_fill = 0) |> 
    ungroup() |> 
    janitor::adorn_totals(where = c("row", "col"), name = "Total")
}
```

**R-3: I can write robust programs that are resistant to changes in inputs.**

-   Example (any context)

```{r}
#| label: r-3-example
# Lab 4 Q6
ca_childcare |> 
  filter(study_year == 2018) |> 
  select(census_region, study_year, mc_infant) |> 
  group_by(census_region, study_year) |>
  summarise(median_mc_infant = median(mc_infant, na.rm = TRUE), .groups = "drop") |>
  pivot_wider(names_from = study_year,
              values_from = median_mc_infant) |> 
  slice_min(`2018`)
```

-   Example (function stops)

```{r}
#| label: r-3-function-stops
# Lab 10 Q1
randomBabies <- function(n_babies){
  if (!is.numeric(n_babies)) return(NA)
  
  babies_born <- tibble(mother = 1:n_babies,
                        baby = sample(1:n_babies,
                                      size = n_babies,
                                      replace = FALSE))
  
  correct_returns <- babies_born |> 
    filter(mother == baby) |> 
    nrow()
}
```

## Data Visualization & Summarization

**DVS-1: I can create visualizations for a *variety* of variable types (e.g., numeric, character, factor, date)**

-   At least two numeric variables

```{r}
#| label: dvs-1-num
# Lab 2 Q4
ggplot(data = surveys,
       mapping = aes(x = weight, y = hindfoot_length)) +
  geom_point(alpha = 0.3) +
  facet_wrap(~species) +
  labs(title = "Relationship between weight and length of hindfoot by species",
       subtitle = "Length of Hindfoot (cm)",
       x = "Weight (g)", y = "")
```

-   At least one numeric variable and one categorical variable

```{r}
#| label: dvs-1-num-cat
# Lab 2 Q8
ggplot(data = surveys,
       mapping = aes(x = species, y = weight, fill = sex)) +
  geom_jitter(color = '#7C6BB0FF' , alpha = 0.2) +
  geom_boxplot(outliers = FALSE)+
  scale_fill_manual(values = c("F" = "#4060C8FF", "M" = "#F28AAAFF")) +
  labs(
    title = "Distribution of weight seen in different species" ,
    x = 'Species', y = 'Weight (g)') +
  theme(axis.text.x = element_text(size = 5))
```

-   At least two categorical variables

```{r}
#| label: dvs-1-cat
# Lab 7 Q3, modified
fish |> 
  filter(if_any(trip:species, is.na)) |> 
  group_by(year, section, trip) |>
  summarize(weight_na = sum(is.na(weight)), .groups = "drop") |> 
  mutate(
    year     = as.factor(year),
    section  = fct_relevel(as.factor(section), "Johnsrud", "ScottyBrown"),
    trip     = as.factor(trip)
  ) |> 
  ggplot(aes(x = year, y = weight_na, fill = trip)) +
  geom_col(width = 0.8) +  
  facet_wrap(~ section, ncol = 1) +
  labs(
    x = "Year",
    y = "Frequency of Weight NAs",
    fill = "Trip",
    subtitle = "Seperated by fishing section and stacked by trip",
    title = "Missing weight measurements from trout observations"
  ) +
  theme_minimal(base_size = 12) +
  theme(axis.text.x = element_text( hjust = 1)) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.08)))
```

-   Dates (time series plot)

```{r}
#| label: dvs-1-date
# Lab 4 Q7
ggplot(data = one_table,
       mapping = aes(x = study_year, y = median_childcare, 
                  color = fct_reorder2(.f = census_region, 
                                       .x = study_year, 
                                       .y = median_childcare, 
                                       .fun = last2, 
                                       .desc = TRUE))) +
  # Raw data points
  geom_point() +
  # Smoothed median line
  geom_smooth(method = "loess",
              se= TRUE,
              linewidth = 1.2) +
  facet_wrap(~ age_group, nrow = 1, scales = "fixed") + 
  scale_x_continuous(limits = c(2008,2018),
                     breaks = seq(2008, 2024, by = 2),
                     minor_breaks = NULL) +
  scale_y_continuous(limits = c(0,500),
                     breaks = seq(0,500, by = 100),
                     labels = scales::dollar_format(accuracy = 1)) +
  labs(title = "Weekly Median Price for Center-Based Childcare ($)",
       x = "Study Year", y = "",
       color = "California Region") +
  theme(aspect.ratio = 1,
        axis.text.x = element_text(size = 6))
```

**DVS-2: I use plot modifications to make my visualization clear to the reader.**

-   I can modify my plot theme to be more readable

```{r}
#| label: dvs-2-ex-1
# Lab 7 Q3, modified
fish |> 
  filter(if_any(trip:species, is.na)) |> 
  group_by(year, section, trip) |>
  summarize(weight_na = sum(is.na(weight)), .groups = "drop") |> 
  mutate(
    year     = as.factor(year),
    section  = fct_relevel(as.factor(section), "Johnsrud", "ScottyBrown"),
    trip     = as.factor(trip)
  ) |> 
  ggplot(aes(x = year, y = weight_na, fill = trip)) +
  geom_col(width = 0.8) +  
  facet_wrap(~ section, ncol = 1) +
  labs(
    x = "Year",
    y = "Frequency of Weight NAs",
    fill = "Trip",
    subtitle = "Seperated by fishing section and stacked by trip",
    title = "Missing weight measurements from trout observations"
  ) +
  theme_minimal(base_size = 12) +
  theme(axis.text.x = element_text( hjust = 1)) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.08)))
```

-   I can modify my colors to be accessible to anyone's eyes

```{r}
#| label: dvs-2-ex-2
# Lab 4 Q8
ggplot(data = ca_childcare,
       mapping = aes(x = mhi_2018, y = mc_infant)) +
  geom_point(color = 'blueviolet') +
  geom_smooth(color = 'darkorange2', method = lm) +
  labs(title = "Linear relationship between income and price of childcare for an infant",
       x = 'Median Household Income (2018 dollars)', 
       y = 'Median weekly price for center-based childcare') +
  scale_x_continuous(labels = scales::dollar) +
  scale_y_continuous(labels = scales::dollar)
```

-   I can modify my plot titles to clearly communicate the data context

```{r}
#| label: dvs-2-ex-3
# Lab 4 Q8
ggplot(data = ca_childcare,
       mapping = aes(x = mhi_2018, y = mc_infant)) +
  geom_point(color = 'blueviolet') +
  geom_smooth(color = 'darkorange2', method = lm) +
  labs(title = "Linear relationship between income and price of childcare for an infant",
       x = 'Median Household Income (2018 dollars)', 
       y = 'Median weekly price for center-based childcare') +
  scale_x_continuous(labels = scales::dollar) +
  scale_y_continuous(labels = scales::dollar)
```

-   I can modify the text in my plot to be more readable

```{r}
#| label: dvs-2-ex-4
# Lab 4 Q8
ggplot(data = ca_childcare,
       mapping = aes(x = mhi_2018, y = mc_infant)) +
  geom_point(color = 'blueviolet') +
  geom_smooth(color = 'darkorange2', method = lm) +
  labs(title = "Linear relationship between income and price of childcare for an infant",
       x = 'Median Household Income (2018 dollars)', 
       y = 'Median weekly price for center-based childcare') +
  scale_x_continuous(labels = scales::dollar) +
  scale_y_continuous(labels = scales::dollar)

```

-   I can reorder my legend to align with the colors in my plot

```{r}
#| label: dvs-2-ex-5
# Lab 4 Q7
ggplot(data = one_table,
       mapping = aes(x = study_year, y = median_childcare, 
                  color = fct_reorder2(.f = census_region, 
                                       .x = study_year, 
                                       .y = median_childcare, 
                                       .fun = last2, 
                                       .desc = TRUE))) +
  # Raw data points
  geom_point() +
  # Smoothed median line
  geom_smooth(method = "loess",
              se= TRUE,
              linewidth = 1.2) +
  facet_wrap(~ age_group, nrow = 1, scales = "fixed") + 
  scale_x_continuous(limits = c(2008,2018),
                     breaks = seq(2008, 2024, by = 2),
                     minor_breaks = NULL) +
  scale_y_continuous(limits = c(0,500),
                     breaks = seq(0,500, by = 100),
                     labels = scales::dollar_format(accuracy = 1)) +
  labs(title = "Weekly Median Price for Center-Based Childcare ($)",
       x = "Study Year", y = "",
       color = "California Region") +
  theme(aspect.ratio = 1,
        axis.text.x = element_text(size = 6))
```

**DVS-3: I show creativity in my visualizations**

-   I can use non-standard colors (Example 1)

```{r}
#| label: dvs-3-1-ex-1
# Lab 2 Q8
ggplot(data = surveys,
       mapping = aes(x = species, y = weight, fill = sex)) +
  geom_jitter(color = '#7C6BB0FF' , alpha = 0.2) +
  geom_boxplot(outliers = FALSE) +
  scale_fill_manual(values = c("F" = "#4060C8FF", "M" = "#F28AAAFF")) +
  labs(title = "Distribution of weight seen in different species",
       x = 'Species', y = 'Weight (g)') +
  theme(axis.text.x = element_text(size = 5))
```

-   I can use non-standard colors (Example 2)

```{r}
#| label: dvs-3-1-ex-2
# Challenge 4 Plot
ggplot(data = plot_data,
       mapping = aes(x = median_value, y = mc_infant, fill = metric)) +
  geom_point(aes(color = metric), alpha = 0.2) +
  geom_smooth(method = 'lm') +
  scale_color_viridis(discrete = TRUE, option = "A") +
  scale_fill_viridis(discrete = TRUE) +
  theme(panel.background = element_rect(fill = 'white')) +
  labs(title = "Male and female earnings relationship with infant childcare costs ($)",
       x = "Median earnings ($)",
       y = "Median Center-Based Infant Childare Costs ($)")
```

-   I can use annotations (e.g., `geom_text()`)

```{r}
#| label: dvs-3-2
# Lab 10 Q13
ci_dat_df |> 
  slice_sample(n = 100) |> 
  mutate(order = row_number()) |> 
  
ggplot(mapping = aes(y = order, xmin = conf.low, xmax = conf.high)) +
  geom_errorbar(aes(color = factor(cover))) +
  geom_vline(xintercept = 0.5, linetype = "dashed") +
  annotate("text", x = 1, y = 105, label = "population slope = 0.5") +
  scale_x_continuous(breaks = seq(-2, 2, by = 0.5)) +
  scale_color_manual(values = c("0" = "red", "1" = "skyblue"), guide = "none") +
  labs(
    title = "95% Confidence Intervals of Estimated Regression Slope\nfor 100 Simulatied Datasets",
    subtitle = "CIs that <b>do not</b> include the population slope are highlighted in <span style='color:red;'>red</span>",
    x = "Slope Coefficient Estimate",
    y = ""
  ) +
  theme_minimal() +
  theme(
    axis.text.y = element_blank(),
    plot.subtitle = ggtext::element_markdown()
  )
```

-   I can choose creative geometries (e.g., `geom_segment()`, `geom_ribbon)()`)

```{r}
#| label: dvs-3-3
# Lab 10 Q13
ci_dat_df |> 
  slice_sample(n = 100) |> 
  mutate(order = row_number()) |> 
  
ggplot(mapping = aes(y = order, xmin = conf.low, xmax = conf.high)) +
  geom_errorbar(aes(color = factor(cover))) +
  geom_vline(xintercept = 0.5, linetype = "dashed") +
  annotate("text", x = 1, y = 105, label = "population slope = 0.5") +
  scale_x_continuous(breaks = seq(-2, 2, by = 0.5)) +
  scale_color_manual(values = c("0" = "red", "1" = "skyblue"), guide = "none") +
  labs(
    title = "95% Confidence Intervals of Estimated Regression Slope\nfor 100 Simulatied Datasets",
    subtitle = "CIs that <b>do not</b> include the population slope are highlighted in <span style='color:red;'>red</span>",
    x = "Slope Coefficient Estimate",
    y = ""
  ) +
  theme_minimal() +
  theme(
    axis.text.y = element_blank(),
    plot.subtitle = ggtext::element_markdown()
  )
```

**DVS-4: I can calculate numerical summaries of variables.**

-   Example using `summarize()`

```{r}
#| label: dvs-4-summarize
# Lab 3 Q6
teacher_evals_clean |> 
  summarise(
    unique_instructors = n_distinct(teacher_id),
    unique_courses = n_distinct(course_id))
```

-   Example using `across()`

```{r}
#| label: dvs-4-across
# Challenge 4 Table Modified
ca_childcare |>
  select(study_year, mhi_2018, me_2018, fme_2018, mc_infant) |>
  group_by(study_year) |>
  summarise(
    across(
      .cols = c(mc_infant, mhi_2018, fme_2018, me_2018),
      .fns = ~ median(.x, na.rm = TRUE)),
    .groups = "drop") |> 
  rename("Median Childcare Cost" = mc_infant,
         "Median Household Income" = mhi_2018,
         "Median Female Earnings" = fme_2018,
         "Median Male Earnings" = me_2018)
```

**DVS-5: I can find summaries of variables across multiple groups.**

-   Example 1

```{r}
#| label: dvs-5-1
# Lab 3 Q6
teacher_evals_clean |> 
  ungroup() |> 
  summarise(
    unique_instructors = n_distinct(teacher_id),
    unique_courses = n_distinct(course_id)
  )
```

-   Example 2

```{r}
#| label: dvs-5-2
# Lab 4 Q5
median_house_income <- ca_childcare |> 
  select(census_region, study_year, mhi_2018) |> 
  group_by(census_region, study_year) |> 
  summarise(median_mhi = median(mhi_2018, na.rm = TRUE), .groups = "drop") |> 
  pivot_wider(names_from = study_year,
              values_from = median_mhi,
              names_prefix = "year_") |> 
  select(census_region,`year_2008`, `year_2018`) |> 
  arrange(desc(`year_2018`))

median_house_income

```

**DVS-6: I can create tables which make my summaries clear to the reader.**

-   I can modify my column names to clearly communicate the data context

```{r}
#| label: dvs-6-ex-1
# Challenge 4 Table
median_sex_income <- ca_childcare |> 
  select(study_year, mhi_2018, me_2018, fme_2018, mc_infant) |> 
  group_by(study_year) |> 
  summarise("Median Childcare Cost" = median(mc_infant, na.rm = TRUE),
            "Median Household Income" = median(mhi_2018, na.rm = TRUE),
            "Median Female Earnings" = median(fme_2018, na.rm = TRUE),
            "Median Male Earnings" = median(me_2018, na.rm = TRUE),
            .groups = "drop") 

median_sex_income
```

-   I can modify the text in my table to be more readable (e.g., bold face for column headers)

```{r}
#| label: dvs-6-ex-2

```

-   I can arrange my table to have an intuitive ordering

```{r}
#| label: dvs-6-ex-3
# Lab 4 Q5
median_house_income <- ca_childcare |> 
  select(census_region, study_year, mhi_2018) |> 
  group_by(census_region, study_year) |> 
  summarise(median_mhi = median(mhi_2018, na.rm = TRUE), .groups = "drop") |> 
  pivot_wider(names_from = study_year,
              values_from = median_mhi,
              names_prefix = "year_") |> 
  select(census_region,`year_2008`, `year_2018`) |> 
  arrange(desc(`year_2018`))

median_house_income
```

**DVS-7: I show creativity in my tables.**

-   I can use non-default colors

```{r}
#| label: dvs-7-ex-1

```

-   I can modify the layout of my table to be more readable (e.g., `pivot_longer()` or `pivot_wider()`)

```{r}
#| label: dvs-7-ex-2

```

## Program Efficiency

**PE-1: I can write concise code which does not repeat itself.**

-   using a single function call with multiple inputs (rather than multiple function calls)

```{r}
#| label: pe-1-one-call
# Lab 3 Q5
teacher_evals_clean <- teacher_evals |> 
  rename(sex = gender) |> 
   mutate(teacher_id = as.character(teacher_id),
          no_participants = as.numeric(no_participants),
          question_no = as.character(question_no)) |> 
   filter(no_participants > 10) |>
   select(course_id,
          teacher_id,
          question_no,
          no_participants,
          resp_share,
          SET_score_avg,
          percent_failed_cur,
          academic_degree,
          seniority,
          sex)
  
teacher_evals_clean
```

-   using `across()`

```{r}
#| label: pe-1-across
# Challenge 4 Table Modified
ca_childcare |>
  select(study_year, mhi_2018, me_2018, fme_2018, mc_infant) |>
  group_by(study_year) |>
  summarise(
    across(
      .cols = c(mc_infant, mhi_2018, fme_2018, me_2018),
      .fns = ~ median(.x, na.rm = TRUE)),
    .groups = "drop") |> 
  rename("Median Childcare Cost" = mc_infant,
         "Median Household Income" = mhi_2018,
         "Median Female Earnings" = fme_2018,
         "Median Male Earnings" = me_2018)
```

-   using functions from the `map()` family

```{r}
#| label: pe-1-map-1

```

**PE-2: I can write functions to reduce repetition in my code.**

-   Example 1: Function that operates on vectors

```{r}
#| label: pe-2-1

```

-   Example 2: Function that operates on data frames

```{r}
#| label: pe-2-2

```

-   Example 3: Function that operates on vectors *or* data frames

```{r}
#| label: pe-2-3

```

**PE-3:I can use iteration to reduce repetition in my code.**

-   using `across()`

```{r}
#| label: pe-3-across
# Challenge 4 Table Modified
ca_childcare |>
  select(study_year, mhi_2018, me_2018, fme_2018, mc_infant) |>
  group_by(study_year) |>
  summarise(
    across(
      .cols = c(mc_infant, mhi_2018, fme_2018, me_2018),
      .fns = ~ median(.x, na.rm = TRUE)),
    .groups = "drop") |> 
  rename("Median Childcare Cost" = mc_infant,
         "Median Household Income" = mhi_2018,
         "Median Female Earnings" = fme_2018,
         "Median Male Earnings" = me_2018)
```

-   using a `map()` function with **one** input (e.g., `map()`, `map_chr()`, `map_dbl()`, etc.)

```{r}
#| label: pe-3-map-1

```

-   using a `map()` function with **more than one** input (e.g., `map_2()` or `pmap()`)

```{r}
#| label: pe-3-map-2

```

**PE-4: I can use modern tools when carrying out my analysis.**

-   I can use functions which are not superseded or deprecated

```{r}
#| label: pe-4-1
# Lab 3 Q8
missing_values <- teacher_evals_clean |> 
  group_by(teacher_id, course_id) |> 
  filter(
    if_any(
      .cols = everything(),
      .fns = ~ is.na(.x) 
     ))

missing_values
```

-   I can connect a data wrangling pipeline into a `ggplot()`

```{r}
#| label: pe-4-2
#Challenge 4 Plot Modified
ca_childcare |> 
  select(me_2018, fme_2018, mme_2018, mc_infant) |>
  pivot_longer(cols = c('me_2018', 'fme_2018', 'mme_2018'),
               names_to = "metric",
               values_to = "median_value") |> 
  ggplot(mapping = aes(x = median_value, y = mc_infant, fill = metric)) +
    geom_point(aes(color = metric), alpha = 0.2) +
    geom_smooth(method = 'lm') +
    scale_color_viridis(discrete = TRUE, option = "A") +
    scale_fill_viridis(discrete = TRUE) +
    theme(panel.background = element_rect(fill = 'white')) +
    labs(title = "Male and female earnings relationship with infant childcare costs ($)",
         x = "Median earnings ($)",
         y = "Median Center-Based Infant Childare Costs ($)")
```

## Data Simulation & Statisical Models

**DSSM-1: I can simulate data from a *variety* of probability models.**

-   Example 1

```{r}
#| label: dsm-1-1

```

-   Example 2

```{r}
#| label: dsm-1-2

```

**DSSM-2: I can conduct common statistical analyses in R.**

-   Example 1

```{r}
#| label: dsm-2-1
# Challenge 3 Q3 Modified
chisq.test(teacher_evals_compare$sen_level, teacher_evals_compare$SET_level)
```

-   Example 2

```{r}
#| label: dsm-2-2
# Lab 4 Q9
reg_mod1 <- lm(mc_infant ~ mhi_2018, data = ca_childcare)
summary(reg_mod1)
```

-   Example 3

```{r}
#| label: dsm-2-3

```

## Revising My Thinking

In this class, I have worked hard to read over all the comments of that are given to me on each lab and challenge. I attempt to complete the revisions and work with my classmates as well as Dr. T to understand each function and the accompanying syntax. I try to incorporate the comments I receive in previous assignments to future ones. For example, in Lab 2 I received a comment to include the units in the axis labels in graphs, and I made sure to include them in the graphs in Lab 4.

## Extending My Thinking

I've extended my thinking by using Google and ChatGPT to better format my code and use the most efficient methods. I have also found alternative colors and themes for my visualizations. For example, in Lab 4 I used Google to find a color palette library for my graphs. I had to use the documentation to figure out new ways to use the palette in my visuals and use the correct syntax.

## Peer Support & Collaboration

These are some examples of feedback I gave to my peers:

Lab 5: Hi! Overall your code spacing after the commas and before and after your equal signs look great. You also consistently created a new line after each pipe operator. In the future, I would suggest aligning tabs for the the arguments in a function. Great job!

Lab 3: Hi Caleb! I like that you consistently had good spacing on either side of your equal signs and a space after your commas. You also always started a new row after each pipe which is great. One recommendation that I have is to make new rows in the longer blocks of code. Changing the format to be more vertical, rather than horizontal, will make your code more readable and the user won't need to scroll to see all the code.

During the weekly pair programming, I think I have been a good partner because I respect the roles that we are each in. I only offer additional help or ask for additional help when we get really stuck in a problem. I always try to listen and try out my partner's ideas when I get stuck.
